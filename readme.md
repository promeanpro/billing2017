Установка:

1) Установить vagrant и virtualbox
2) В корневой директории проекта запустить ./vagrant up

Зайти на виртуалку (vagrant ssh)

3) cd /vagrant && yii migrate.
4) yii daemons/restart
5) Хосты в вагранте настроены на billing.local, не забудьте прописать в хост вашей OS 
192.168.33.10 billing.local
6) Для теста работоспособности проще всего запустить функциональные тесты 
vagrant@vagrant-ubuntu-trusty-64:/vagrant$ php vendor/bin/codecept run api

Допущения:

В: Находится ли микросервис в безопасной зоне? Т.е. нужно ли заниматься авторизацией пользователя?
Ответ от Дениса: Не нужно заниматься авторизацией


Описание задачи:

Тестовое задание PHP 

Микросервис баланса пользователей.

Приложение хранит в себе идентификаторы пользователей и их баланс. Взаимодействие с ним осуществляется исключительно с помощью брокера очередей.

По требованию внешней системы, микросервис может выполнить одну из следующих операций со счетом пользователя:

Списание
Зачисление
Блокирование с последующим списанием или разблокированием. Заблокированные средства недоступны для использования. Блокировка означает что некая операция находится на авторизации и ждет какого-то внешнего подтверждения, ее можно впоследствии подтвердить или отклонить
Перевод от пользователя к пользователю
При проведении любой из этих операций генерируется событие в одну из очередей.

Основные требования к воркерам:

Код воркеров должен безопасно выполняться параллельно в разных процессах
Воркеры могут запускаться одновременно в любом числе экземпляров и выполняться произвольное время
Все операции должны обрабатываться корректно, без двойных списаний.
Будет плюсом покрытие кода юнит-тестами.

В пояснительной записке к выполненному заданию необходимо указать перечень используемых инструментов и технологий,  способ развертки приложения.

 

Требования к окружению:

Язык программирования: PHP >= 5.5, стандарт кодирования - PSR-2

Можно использовать: любые фреймворки, БД, брокеры очередей, key-value хранилища.





